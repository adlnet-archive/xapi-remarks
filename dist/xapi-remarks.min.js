/*! xapi-remarks v 0.5.0 | Built on 2015-04-28 12:09:51-0400 */
!function(a){function b(a,b,c){c={};for(var d in a)c[d]=a[d];for(var d in b)c[d]=b[d];return c}function c(a){var b=[];return a.forEach(function(a){null==a.match(f)?ouri=d+"activities/"+encodeURI(a):(ouri=a,a=ouri.split(/\//).pop()),b.push({definition:{name:{"en-US":a}},id:ouri,objectType:"Activity"})}),b}var d="http://example.com/",e=["answered","asked","attempted","attended","commented","completed","exited","experienced","failed","imported","initialized","interacted","launched","mastered","passed","preferred","progressed","registered","responded","resumed","scored","shared","suspended","terminated","voided"],f=/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi,g=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,h=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/,i=/^[a-f0-9]{40}$/;XAPIRemarks=function(){this.remarkToArray=function(a){var b=/(<.+>) (<.+>) (<.+>)(\s?(\(.+\)))?(\s?(\{.+\}))?(\s?(\[.+\]))?/,c=a.match(b);if(c){var d=[],e=0;return c.forEach(function(a){0!=e&&4!=e&&6!=e&&8!=e&&void 0!=a&&d.push(a),e++}),d}},this.remarkArrayToStatement=function(a){if(!Array.isArray(a))return console.warn("remarkArrayToStatement did not receive an array"),!1;if(a.length>3)var j=a.slice(0,3),k=a.slice(3);else var j=a;var l=j[0].slice(1).slice(0,-1),m=j[1].slice(1).slice(0,-1),n=j[2].slice(1).slice(0,-1),o={actor:{},verb:{display:{"en-US":""},id:""},object:{}},p=l.split(" | "),q=p[0],r=p[1];q.match(g)?o.actor={mbox:"mailto:"+q,objectType:"Agent"}:q.match(i)?o.actor={mbox_sha1sum:q,objectType:"Agent"}:q.match(f)?o.actor={openid:q,objectType:"Agent"}:console.warn("No valid Actor string found"),void 0!=r&&(o.actor.name=r);var s=m.split(" | "),t=s[0],u=s[1];if(-1!=e.indexOf(t)){var v="http://adlnet.gov/expapi/verbs/"+encodeURIComponent(t);void 0==u&&(u=t)}else if(null==m.match(f)){var v=d+"verbs/"+encodeURIComponent(t);void 0==u&&(u=t)}else{var v=t;void 0==u&&(u=v.split(/\//).pop())}if(o.verb.id=v,o.verb.display["en-US"]=u,o.object=n.match(g)?{mbox:"mailto:"+n,objectType:"Agent"}:n.match(h)?{id:n,objectType:"StatementRef"}:n.match(f)?{id:n,objectType:"Activity"}:{id:d+"activities/"+encodeURI(n),objectType:"Activity"},k){var w={};k.forEach(function(a){var d=a.substring(0,1);switch(d){case"(":obj=JSON.parse(a.replace(/\(/g,"{").replace(/\)/g,"}").replace(/([sdrwc]{1}|score|duration|response|completion|success): (\[|"|true|false)/g,'"$1": $2').trim()),w={result:{}};for(var e in obj)switch(e){case"s":case"score":var f=obj[e];w.result.score={raw:f[0],min:f[1],max:f[2]};break;case"success":case"w":var g=obj[e];w.result.success=g;break;case"completion":case"c":var h=obj[e];w.result.completion=h;break;case"response":case"r":var i=obj[e];w.result.response=i;break;case"duration":case"d":var j=obj[e];w.result.duration=j}break;case"{":obj=JSON.parse(a.replace(/\(/g,"{").replace(/\)/g,"}").replace(/([pgco]{1}|parent|grouping|category|other): (\[|")/g,'"$1": $2').trim()),w={context:{contextActivities:{}}};for(var e in obj)switch(e){case"parent":case"p":w.context.contextActivities.parent=c(obj[e]);break;case"grouping":case"g":w.context.contextActivities.grouping=c(obj[e]);break;case"category":case"c":w.context.contextActivities.category=c(obj[e]);break;case"other":case"o":w.context.contextActivities.other=c(obj[e])}break;case"[":}o=b(o,w)})}return o}},a.XAPIRemarks=new XAPIRemarks}(window.ADL=window.ADL||{});