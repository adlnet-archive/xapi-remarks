/*! xapi-remarks v 0.5.0 | Built on 2015-04-10 09:17:22-0400 */
!function(a){function b(a,b,c){c={};for(var d in a)c[d]=a[d];for(var d in b)c[d]=b[d];return c}var c="http://example.com/",d=["answered","asked","attempted","attended","commented","completed","exited","experienced","failed","imported","initialized","interacted","launched","mastered","passed","preferred","progressed","registered","responded","resumed","scored","shared","suspended","terminated","voided"],e=/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi,f=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,g=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/,h=/^[a-f0-9]{40}$/;XAPIRemarks=function(){this.remarkToArray=function(a){var b=/(<.+>) (<.+>) (<.+>)(\s?(\(.+\)))?(\s?(\{.+\}))?(\s?(\[.+\]))?/,c=a.match(b);if(c){var d=[],e=0;return c.forEach(function(a){0!=e&&4!=e&&6!=e&&8!=e&&void 0!=a&&d.push(a),e++}),d}},this.remarkArrayToStatement=function(a){if(!Array.isArray(a))return console.warn("remarkArrayToStatement did not receive an array"),!1;if(a.length>3)var i=a.slice(0,3),j=a.slice(3);else var i=a;var k=i[0].slice(1).slice(0,-1),l=i[1].slice(1).slice(0,-1),m=i[2].slice(1).slice(0,-1),n={actor:{},verb:{display:{"en-US":""},id:""},object:{}},o=k.split(" | "),p=o[0],q=o[1];p.match(f)?n.actor={mbox:"mailto:"+p,objectType:"Agent"}:p.match(h)?n.actor={mbox_sha1sum:p,objectType:"Agent"}:p.match(e)?n.actor={openid:p,objectType:"Agent"}:console.warn("No valid Actor string found"),void 0!=q&&(n.actor.name=q);var r=l.split(" | "),s=r[0],t=r[1];if(-1!=d.indexOf(s)){var u="http://adlnet.gov/expapi/verbs/"+encodeURIComponent(s);void 0==t&&(t=s)}else if(null==l.match(e)){var u=c+"verbs/"+encodeURIComponent(s);void 0==t&&(t=s)}else{var u=s;void 0==t&&(t=u.split(/\//).pop())}if(n.verb.id=u,n.verb.display["en-US"]=t,n.object=m.match(f)?{mbox:"mailto:"+m,objectType:"Agent"}:m.match(g)?{id:m,objectType:"StatementRef"}:m.match(e)?{id:m,objectType:"Activity"}:{id:c+"activities/"+encodeURI(m),objectType:"Activity"},j){var v={};j.forEach(function(a){var d=a.substring(0,1);switch(d){case"(":obj=JSON.parse(a.replace(/\(/g,"{").replace(/\)/g,"}").replace(/([sdrwc]{1}): (\[|"|true|false)/g,'"$1": $2').trim()),v={result:{}};for(var f in obj)switch(f){case"s":var g=obj[f];v.result.score={raw:g[0],min:g[1],max:g[2]};break;case"w":var h=obj[f];v.result.success=h;break;case"c":var i=obj[f];v.result.completion=i;break;case"r":var j=obj[f];v.result.response=j;break;case"d":var k=obj[f];v.result.duration=k}break;case"{":obj=JSON.parse(a.replace(/\(/g,"{").replace(/\)/g,"}").replace(/([pg]{1}): (\[|")/g,'"$1": $2').trim()),v={context:{contextActivities:{}}};for(var f in obj)switch(f){case"p":var l=obj[f],m=[];l.forEach(function(a){null==a.match(e)?puri=c+"activities/"+encodeURI(a):(puri=a,a=puri.split(/\//).pop()),m.push({definition:{name:{"en-US":a}},id:puri,objectType:"Activity"})}),v.context.contextActivities.parent=m;break;case"g":var o=obj[f],p=[];o.forEach(function(a){null==a.match(e)?guri=c+"activities/"+encodeURI(a):(guri=a,a=puri.split(/\//).pop()),p.push({definition:{name:{"en-US":a}},id:guri,objectType:"Activity"})}),v.context.contextActivities.grouping=p}break;case"[":}n=b(n,v)})}return n}},a.XAPIRemarks=new XAPIRemarks}(window.ADL=window.ADL||{});